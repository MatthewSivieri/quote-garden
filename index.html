<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quote Garden</title>
  <meta name="description" content="A lightweight, single-file quotes notebook with categories, search, sourcing, and shareable filter links." />
  <style>
    :root{
      --bg:#ffffff;
      --text:#0f1720;
      --muted:#5b6675;
      --panel:#f6f8fb;
      --border:#e5e9f0;
      --accent:#1f4fff;
      --card:#ffffff;
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{display:grid; grid-template-columns:280px 1fr; gap:20px; max-width:1200px; margin:0 auto; padding:24px}
    header{grid-column:1/-1; display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .title{font-weight:800; letter-spacing:.2px; font-size:24px}
    .spacer{flex:1 1 auto}
    .search{display:flex; gap:8px; align-items:center}
    .search input{flex:1; min-width:260px; background:var(--panel); border:1px solid var(--border); color:var(--text); padding:12px 14px; border-radius:12px}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:10px 12px; background:var(--panel); border:1px solid var(--border); border-radius:12px; color:var(--muted)}
    .sidebar{position:sticky; top:16px; align-self:start; background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:16px}
    .sidebar h3{margin:6px 0 10px; font-size:13px; color:var(--muted); text-transform:uppercase; letter-spacing:.12em}
    select, .btn{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:#fff; color:var(--text);
    }
    .btn{cursor:pointer; background:#fff}
    .tools{display:grid; gap:8px; grid-template-columns:1fr}
    .content{display:grid; grid-template-columns:repeat(1,minmax(0,1fr)); gap:14px}
    @media (min-width: 860px){ .content{grid-template-columns:repeat(2,minmax(0,1fr));} }
    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px; display:flex; flex-direction:column; gap:12px; box-shadow:0 2px 10px rgba(10,20,30,.04)}
    .q{font-family: Georgia, Cambria, 'Times New Roman', Times, serif; font-size:19px}
    .meta{display:flex; flex-wrap:wrap; gap:8px; color:var(--muted)}
    .sourcing{display:flex; flex-wrap:wrap; gap:6px; color:var(--muted)}
    .label{font-weight:600; color:#445160}
    .badges{display:flex; gap:8px; flex-wrap:wrap; margin-top:2px}
    .badge{padding:4px 8px; border-radius:999px; background:#eef2ff; border:1px solid #d9e0ff; font-size:12px; color:#2740aa}
    .badge.tag{background:#f1f5f9; border-color:#e3e9f0; color:#485565}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap}
    .footer{grid-column:1/-1; color:var(--muted); text-align:center; padding:16px}
    .hr{height:1px; background:var(--border); margin:12px 0}
    .empty{opacity:.7; text-align:center; padding:24px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">Quote Garden</div>
      <div class="spacer"></div>
      <div class="pill" id="count">0 quotes</div>
      <div class="search">
        <input id="searchInput" type="search" placeholder="Search text, author, source, tags (⌘/Ctrl+K)" aria-label="Search" />
      </div>
    </header>

    <aside class="sidebar" aria-label="Filters and tools">
      <h3>Category</h3>
      <select id="categorySelect" aria-label="Select category">
        <option value="">All</option>
      </select>
      <div class="hr"></div>
      <h3>Tools</h3>
      <div class="tools">
        <button class="btn" id="clearFilters">Clear filters</button>
        <button class="btn" id="copyLink">Copy shareable link</button>
        <button class="btn" id="exportJson">Export JSON</button>
      </div>
      <p style="color:var(--muted); margin-top:10px">Tip: Add quotes by editing this file’s JSON block and committing.</p>
    </aside>

    <main class="content" id="cards" aria-live="polite"></main>

    <div class="footer">Static and durable. Host anywhere.</div>
  </div>

  <!-- Data store: edit this JSON array to add or change quotes. -->
  <script id="data" type="application/json">{
    "quotes": [
      {
        "id": "thucydides-freedom-courage",
        "text": "The secret of happiness is freedom, and the secret of freedom is courage.",
        "author": "Thucydides",
        "source": "History of the Peloponnesian War (2.40)",
        "url": "https://www.perseus.tufts.edu/hopper/text?doc=Thuc.%202.40",
        "date": "-0429-01-01",
        "categories": ["warfare", "human nature"],
        "tags": ["Athens", "Pericles"]
      },
      {
        "id": "hobbes-bellum-omnium",
        "text": "During the time men live without a common Power to keep them all in awe, they are in that condition which is called War; and such a war, as is of every man, against every man.",
        "author": "Thomas Hobbes",
        "source": "Leviathan (ch. 13)",
        "url": "https://www.gutenberg.org/ebooks/3207",
        "date": "1651-01-01",
        "categories": ["human nature", "politics"],
        "tags": ["state of nature", "conflict"]
      },
      {
        "id": "shakespeare-love",
        "text": "Love looks not with the eyes, but with the mind, and therefore is winged Cupid painted blind.",
        "author": "William Shakespeare",
        "source": "A Midsummer Night's Dream",
        "url": "https://shakespeare.folger.edu/",
        "date": "1595-01-01",
        "categories": ["love", "poetry"],
        "tags": ["Cupid"]
      },
      {
        "id": "owen-dulce",
        "text": "My friend, you would not tell with such high zest to children ardent for some desperate glory, the old Lie; Dulce et decorum est pro patria mori.",
        "author": "Wilfred Owen",
        "source": "Dulce et Decorum Est",
        "url": "https://www.poetryfoundation.org/poems/46560/dulce-et-decorum-est",
        "date": "1917-01-01",
        "categories": ["warfare", "poetry"],
        "tags": ["World War I"]
      },
      {
        "id": "matthew-thesis",
        "text": "Certainty breeds coercion; pluralism preserves liberty.",
        "author": "Matthew Sivieri",
        "source": "Personal notes",
        "url": "",
        "date": "2025-08-12",
        "categories": ["politics", "maxims"],
        "tags": ["pluralism", "liberty"]
      }
    ]
  }</script>

  <script>
    const $ = sel => document.querySelector(sel);
    const data = JSON.parse(document.getElementById('data').textContent);
    const quotes = data.quotes;

    const params = new URLSearchParams(location.search);
    const state = {
      q: params.get('q') || '',
      cat: params.get('cat') || ''
    };

    const searchInput = $('#searchInput');
    const categorySelect = $('#categorySelect');
    const cards = $('#cards');
    const count = $('#count');

    // Build category options
    const allCats = Array.from(new Set(quotes.flatMap(q => q.categories))).sort((a,b)=>a.localeCompare(b));
    allCats.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c; opt.textContent = c;
      categorySelect.append(opt);
    });
    categorySelect.value = state.cat;

    function escapeHtml(s){ return String(s).replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }
    function escapeAttr(s){ return String(s).replace(/"/g,'&quot;'); }

    function matches(q){
      // category: single-select (OR == exact match if set)
      const inCat = !state.cat || (q.categories || []).includes(state.cat);
      if(!inCat) return false;
      const needle = state.q.trim().toLowerCase();
      if(!needle) return true;
      const hay = [q.text, q.author, q.source, ...(q.tags||[]), ...(q.categories||[])].join(' ').toLowerCase();
      return hay.includes(needle);
    }

    function renderCards(list){
      if(list.length===0){ cards.innerHTML = `<div class="empty">No results. Try another category or clear filters.</div>`; return; }
      cards.innerHTML = list.map(q => {
        const cats = (q.categories||[]).map(c=>`<span class="badge">${escapeHtml(c)}</span>`).join('');
        const tags = (q.tags||[]).map(t=>`<span class="badge tag">#${escapeHtml(t)}</span>`).join('');
        const src = escapeHtml(q.source || '');
        const link = q.url ? ` · <a href="${escapeAttr(q.url)}" target="_blank" rel="noopener">source</a>` : '';
        return `
        <article class="card" id="${escapeAttr(q.id)}">
          <div class="q">“${escapeHtml(q.text)}”</div>
          <div class="meta">— <strong>${escapeHtml(q.author)}</strong></div>
          <div class="sourcing"><span class="label">Sourcing:</span> <span>${src}</span>${link}</div>
          <div class="badges">${cats} ${tags}</div>
        </article>`;
      }).join('');
    }

    function updateUrl(){
      const p = new URLSearchParams();
      if(state.q) p.set('q', state.q);
      if(state.cat) p.set('cat', state.cat);
      const url = location.pathname + (p.toString()?`?${p}`:'');
      history.replaceState(null, '', url);
    }

    function update(){
      const filtered = quotes.filter(matches).sort((a,b)=>String(b.date||'').localeCompare(String(a.date||'')));
      renderCards(filtered);
      count.textContent = `${filtered.length} ${filtered.length===1?'quote':'quotes'}`;
      updateUrl();
    }

    // Controls
    searchInput.value = state.q;
    searchInput.addEventListener('input', e=>{ state.q = e.target.value; update(); });
    categorySelect.addEventListener('change', e=>{ state.cat = e.target.value; update(); });
    $('#clearFilters').onclick = ()=>{ state.q=''; state.cat=''; searchInput.value=''; categorySelect.value=''; update(); };
    $('#copyLink').onclick = async ()=>{
      try { await navigator.clipboard.writeText(location.href); alert('Link copied'); } catch { alert('Copy failed'); }
    };
    $('#exportJson').onclick = ()=>{
      const blob = new Blob([JSON.stringify({quotes}, null, 2)], {type:'application/json'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'quotes.json'; a.click(); URL.revokeObjectURL(a.href);
    };

    // Keyboard quick search
    window.addEventListener('keydown', (e)=>{ if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==='k'){ e.preventDefault(); searchInput.focus(); } });

    // Init
    update();
  </script>
</body>
</html>